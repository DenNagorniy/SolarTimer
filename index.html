<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>SolarTimer ‚Äî –í–∞—à –∏–¥–µ–∞–ª—å–Ω—ã–π —Å–≤–µ—Ç–æ–≤–æ–π –¥–µ–Ω—å</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        :root {
            --day-bg: linear-gradient(135deg, #fdf6e3 0%, #ffe29f 60%, #feb47b 100%);
            --night-bg: linear-gradient(135deg, #26355d 0%, #162542 60%, #333c61 100%);
            --day-accent: #f7b01a;
            --night-accent: #5fa8eb;
        }
        body {
            min-height: 100vh;
            background: var(--day-bg);
            color: #222;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Arial, sans-serif;
            transition: background 0.7s;
        }
        body.night {
            background: var(--night-bg);
            color: #f7f7fa;
        }
        /* --- –û–±–ª–∞–∫–∞ --- */
        #clouds {
            position: fixed;
            left: 0; top: 0; width: 100vw; height: 210px;
            pointer-events: none;
            z-index: 0;
            opacity: 0.68;
            transition: opacity .8s;
            filter: blur(0.3px);
            display: none;
        }
        body.day #clouds { display: block; }
        .cloud {
            position: absolute;
            fill: #fff9e7;
            opacity: .77;
            animation: cloudMove linear infinite;
        }
        .cloud1 { left: 4vw; top: 45px; width:110px; animation-duration: 38s;}
        .cloud2 { left: 32vw; top: 12px; width:170px; animation-duration: 55s;}
        .cloud3 { left: 65vw; top: 60px; width:98px; animation-duration: 49s;}
        .cloud4 { left: 18vw; top: 130px; width:96px; animation-duration: 70s;}
        .cloud5 { left: 70vw; top: 110px; width:80px; animation-duration: 87s;}
        .cloud6 { left: 54vw; top: 160px; width:60px; animation-duration: 72s;}
        @keyframes cloudMove {
            0% { transform: translateX(0);}
            100% { transform: translateX(45vw);}
        }
        /* --- –ó–≤–µ–∑–¥—ã --- */
        #stars {
            position: fixed;
            left: 0; top: 0; width: 100vw; height: 100vh;
            pointer-events: none;
            z-index: 0;
            display: none;
        }
        body.night #stars { display: block; }
        .star {
            position: absolute;
            background: #fffbe6;
            border-radius: 50%;
            opacity: .81;
            animation: starTwinkle 3s infinite;
        }
        @keyframes starTwinkle {
            0%,100% { opacity: 0.65;}
            50% { opacity: 1;}
        }
        /* --- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –∏ –∫–∞—Ä—Ç–æ—á–∫–∏ --- */
        .container {
            position: relative;
            max-width: 430px;
            margin: 46px auto 0 auto;
            background: rgba(255,255,255,0.95);
            border-radius: 32px;
            box-shadow: 0 4px 32px 0 #0002, 0 1.5px 6px #00000010;
            padding: 38px 18px 18px 18px;
            text-align: center;
            animation: fadein 1s;
            z-index: 1;
        }
        body.night .container {
            background: rgba(38,45,76, 0.93);
            box-shadow: 0 4px 32px 0 #0006, 0 1.5px 6px #fff2;
        }
        @keyframes fadein {
            from { opacity: 0; transform: translateY(30px);}
            to { opacity: 1; transform: none;}
        }
        .header-row {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 14px;
            margin-bottom: 6px;
        }
        .header {
            font-size: 2.3em;
            font-weight: 900;
            letter-spacing: 1px;
            margin-bottom: 0;
            margin-top: 0;
            transition: color .6s;
            color: var(--day-accent);
            display: flex;
            align-items: center;
            gap: 10px;
            animation: fadeinTitle 1.1s .05s both;
            user-select: none;
        }
        body.night .header { color: var(--night-accent);}
        @keyframes fadeinTitle {
            from { opacity: 0; transform: scale(.85) translateY(-20px);}
            to { opacity: 1; transform: none;}
        }
        .header .icon-astro {
            display: inline-block;
            font-size: 1.18em;
            position: relative;
            cursor: pointer;
            animation: spin 8s linear infinite;
            transition: filter .3s;
        }
        .header .icon-astro.sun {
            text-shadow: 0 0 24px #ffd16a66, 0 0 12px #f7ce3266;
        }
        .header .icon-astro.night {
            animation: swing 5s ease-in-out infinite;
            text-shadow: 0 0 36px #ffc  , 0 0 30px #f7d77455, 0 0 4px #fff3;
            filter: drop-shadow(0 0 12px #fff1);
        }
        .header .icon-astro.manual { filter: brightness(1.3) contrast(1.7) drop-shadow(0 0 8px #58f2fa99);}
        .header .icon-astro .astro-glow { pointer-events: none;}
        .astro-glow {
            position: absolute;
            left: 50%; top: 50%;
            transform: translate(-50%,-50%);
            z-index: 0;
            border-radius: 50%;
            opacity: .77;
        }
        .astro-glow.sun {
            width: 44px; height: 44px;
            background: radial-gradient(circle, #ffe29f 25%, #ffd16a77 50%, #f7ce3233 90%, transparent 100%);
            filter: blur(2px);
            animation: sunGlow 2.4s linear infinite alternate;
        }
        .astro-glow.moon {
            width: 40px; height: 40px;
            background: radial-gradient(circle, #f6f9e8 40%, #fff 90%, transparent 100%);
            filter: blur(4px);
            animation: moonGlow 2.2s linear infinite alternate;
            opacity: .46;
        }
        @keyframes sunGlow {
            0% { opacity: 0.67;}
            100% { opacity: 1;}
        }
        @keyframes moonGlow {
            0% { opacity: 0.28;}
            100% { opacity: 0.54;}
        }
        @keyframes spin {
            0% { transform: rotate(0deg);}
            100% { transform: rotate(360deg);}
        }
        @keyframes swing {
            0%, 100% { transform: rotate(-7deg);}
            50% { transform: rotate(10deg);}
        }
        .astro-override {
            margin-left: 12px;
            font-size: 1.28em;
            color: #e08a00;
            background: #fff6c055;
            border-radius: 50%;
            cursor: pointer;
            padding: 0 11px 2px 11px;
            border: 1px solid #f7ce32;
            opacity: .87;
            transition: opacity .17s, background .24s;
            z-index:2;
            user-select:none;
            box-shadow: 0 2px 4px #fff8;
            height: 1.6em;
            display: flex;
            align-items: center;
        }
        .astro-override:hover { opacity: 1; background: #fff8c077;}
        .inputs-group {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 14px;
            margin-bottom: 22px;
            margin-top: 10px;
        }
        .input-block {
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
        }
        .inputs-row {
            display: flex;
            flex-direction: row;
            align-items: center;
            gap: 10px;
            justify-content: center;
            width: 100%;
        }
        .inputs-row label {
            min-width: 70px;
            text-align: right;
            font-weight: 500;
        }
        input[type="text"], input[type="number"], input[type="date"] {
            padding: 9px 10px;
            border: 1.4px solid #e3e8f0;
            border-radius: 11px;
            font-size: 1.09em;
            background: #fcfbfa;
            text-align: center;
            width: 185px;
            box-shadow: 0 1px 6px #ffe29f10;
            margin-bottom: 0;
            transition: border .23s, background .4s;
        }
        body.night input[type="text"], 
        body.night input[type="number"],
        body.night input[type="date"] {
            background: #30385e;
            color: #f7f7fa;
            border: 1.5px solid #445177;
        }
        input[type="text"]:focus, input[type="number"]:focus, input[type="date"]:focus {
            border: 1.7px solid #fdb469;
            outline: none;
        }
        .coords-fields {
            display: flex;
            gap: 10px;
            width: 100%;
            justify-content: center;
            margin-bottom: 8px;
        }
        .coords-fields input[type="number"] {
            width: 120px;
        }
        .hidden { display: none; }
        .show-coords-btn {
            background: none;
            border: none;
            color: #ea910b;
            cursor: pointer;
            font-size: 1em;
            margin-bottom: 4px;
            margin-top: -3px;
            text-decoration: underline;
            letter-spacing: .02em;
            transition: color .22s;
        }
        .show-coords-btn:hover { color: #fdb469;}
        .main-btn {
            width: 100%;
            background: linear-gradient(90deg, #feb47b 0%, #ffb75e 100%);
            color: #fff;
            border: none;
            border-radius: 12px;
            padding: 15px 0;
            font-size: 1.18em;
            font-weight: 700;
            box-shadow: 0 2px 12px #feb47b21;
            cursor: pointer;
            transition: background .22s, transform .10s;
            letter-spacing: 0.02em;
            margin-bottom: 2px;
            margin-top: 5px;
        }
        .main-btn:active { transform: scale(0.97);}
        .main-btn:hover { background: linear-gradient(90deg,#feb47b 0%, #faad3c 100%);}
        body.night .main-btn {
            background: linear-gradient(90deg, #3b528e 0%, #334266 100%);
            color: #ffe7c4;
            box-shadow: 0 2px 12px #33426622;
        }
        .info {
            background: linear-gradient(95deg, #fffde4 60%, #ffe29f 100%);
            border-radius: 18px;
            padding: 21px 10px;
            margin: 0 0 20px 0;
            box-shadow: 0 2px 10px #e3e8f061;
            display: flex;
            flex-direction: column;
            align-items: center;
            animation: fadein .7s .2s backwards;
        }
        body.night .info {
            background: linear-gradient(95deg, #2d3d5a 60%, #283a54 100%);
        }
        .label-value { margin: 5px 0; font-size: 1.13em; letter-spacing:.01em;}
        .now-block {
            background: #fffefaee;
            border-radius: 16px;
            padding: 15px 7px 11px 7px;
            box-shadow: 0 2px 8px #e3e8f031;
            margin-bottom: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            animation: fadein .7s .2s backwards;
        }
        body.night .now-block {
            background: #2d3555ee;
        }
        .icon-label {
            margin-right: 6px;
            font-size: 1.13em;
            vertical-align: middle;
            opacity:.86;
        }
        @media (max-width: 600px) {
            #clouds, #stars { height: 110px; }
            .container { max-width: 99vw; padding: 16px 3vw 8vw 3vw;}
            .header { font-size: 1.16em; }
            .main-btn { width: 98vw; min-width: 0; }
            .coords-fields input[type="number"], input[type="text"], input[type="date"] { width: 92px; }
            .astro-override { font-size: 1em; padding: 0 9px 2px 9px;}
        }
    </style>
</head>
<body class="day">
    <div id="clouds">
        <svg class="cloud cloud1"><ellipse cx="54" cy="24" rx="54" ry="24"/></svg>
        <svg class="cloud cloud2"><ellipse cx="85" cy="31" rx="85" ry="31"/></svg>
        <svg class="cloud cloud3"><ellipse cx="49" cy="18" rx="49" ry="18"/></svg>
        <svg class="cloud cloud4"><ellipse cx="48" cy="13" rx="48" ry="13"/></svg>
        <svg class="cloud cloud5"><ellipse cx="40" cy="10" rx="40" ry="10"/></svg>
        <svg class="cloud cloud6"><ellipse cx="29" cy="8" rx="29" ry="8"/></svg>
    </div>
    <div id="stars"></div>
    <div class="container">
        <div class="header-row">
            <div class="header" id="header-text">
                SolarTimer 
                <span class="icon-astro sun" id="astro-icon-wrap" style="position:relative;" title="–°–º–µ–Ω–∏—Ç—å —Ç–µ–º—É (—Ä—É—á–Ω–æ–π —Ä–µ–∂–∏–º)">
                    <span class="astro-glow sun" id="astro-glow"></span>
                    <span id="astro-icon" style="position:relative;z-index:2;">‚òÄÔ∏è</span>
                </span>
            </div>
            <span id="astro-override-btn" class="astro-override" style="display:none;" title="–í–µ—Ä–Ω—É—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–∂–∏–º">‚Ü∫</span>
        </div>
        <form class="inputs-group" onsubmit="return false;">
            <div class="input-block">
                <div class="inputs-row">
                    <label for="city">–ì–æ—Ä–æ–¥:</label>
                    <input type="text" id="city" value="" placeholder="–ú–æ—Å–∫–≤–∞, –õ–æ–Ω–¥–æ–Ω...">
                </div>
                <button class="show-coords-btn" onclick="toggleCoords()" type="button">–ü–æ–∫–∞–∑–∞—Ç—å/—Å–∫—Ä—ã—Ç—å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã</button>
            </div>
            <div class="input-block hidden" id="coords-row">
                <div class="coords-fields">
                    <input type="number" id="lat" step="0.0001" placeholder="–®–∏—Ä–æ—Ç–∞">
                    <input type="number" id="lon" step="0.0001" placeholder="–î–æ–ª–≥–æ—Ç–∞">
                </div>
                <button type="button" class="main-btn" onclick="autoDetectLocationAndCity()">–ì–µ–æ–ø–æ–∑–∏—Ü–∏—è</button>
            </div>
            <div class="inputs-row">
                <label for="date">–î–∞—Ç–∞:</label>
                <input type="date" id="date">
            </div>
            <button type="button" class="main-btn" onclick="updateTimes()">–†–∞—Å—Å—á–∏—Ç–∞—Ç—å</button>
        </form>
        <div class="info">
            <div class="label-value"><span class="icon-label">üåÖ</span><span id="sunrise">–í–æ—Å—Ö–æ–¥: --:--</span></div>
            <div class="label-value"><span class="icon-label">üåá</span><span id="sunset">–ó–∞–∫–∞—Ç: --:--</span></div>
            <div class="label-value"><span class="icon-label">üìè</span><span id="day-length">–î–ª–∏–Ω–∞ –¥–Ω—è: -- –º–∏–Ω</span></div>
            <div class="label-value"><span class="icon-label">üåô</span><span id="night-length">–î–ª–∏–Ω–∞ –Ω–æ—á–∏: -- –º–∏–Ω</span></div>
            <div class="label-value"><span class="icon-label">‚òÄÔ∏è</span><span id="day-hour">–°–≤–µ—Ç–æ–≤–æ–π —á–∞—Å: -- –º–∏–Ω</span></div>
            <div class="label-value"><span class="icon-label">üåë</span><span id="night-hour">–ù–æ—á–Ω–æ–π —á–∞—Å: -- –º–∏–Ω</span></div>
        </div>
        <div class="now-block">
            <div class="label-value"><span class="icon-label">‚è∞</span>–¢–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è: <span id="current-time">--:--</span></div>
            <div class="label-value"><span class="icon-label">üïí</span><span id="solar-time">–°–≤–µ—Ç–æ–≤–æ–µ –≤—Ä–µ–º—è: --</span></div>
        </div>
    </div>
<script>
document.getElementById('date').valueAsDate = new Date();

function toggleCoords() {
    document.getElementById('coords-row').classList.toggle('hidden');
}

// --- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∑–≤–µ–∑–¥ –Ω–∞ —Ñ–æ–Ω–µ ---
function genStars() {
    const stars = document.getElementById('stars');
    stars.innerHTML = "";
    const starCount = Math.max(64, Math.floor(window.innerWidth / 8));
    for (let i = 0; i < starCount; i++) {
        const star = document.createElement("div");
        star.className = "star";
        const size = Math.random() * 2.2 + 1.2;
        star.style.width = star.style.height = size + "px";
        star.style.left = (Math.random() * 100) + "vw";
        star.style.top = (Math.random() * 98) + "vh";
        star.style.animationDuration = (2 + Math.random() * 3.5) + "s";
        star.style.opacity = (0.6 + Math.random() * 0.4).toFixed(2);
        stars.appendChild(star);
    }
}
window.addEventListener('resize', ()=>{ if(nightMode) genStars(); });

// --- –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Ç–µ–º—ã ---
let nightMode = false;
let manualTheme = null; // null = –∞–≤—Ç–æ, 'night'/'day' = —Ä—É—á–Ω–æ–π
const astroIcon = document.getElementById('astro-icon');
const astroGlow = document.getElementById('astro-glow');
const iconWrap = document.getElementById('astro-icon-wrap');
const overrideBtn = document.getElementById('astro-override-btn');
const headerText = document.getElementById('header-text');

function setTheme(isNight, triggerFromManual=false) {
    nightMode = isNight;
    document.body.classList.toggle('night', isNight);
    document.body.classList.toggle('day', !isNight);

    // –ê–∫—Ü–µ–Ω—Ç –¥–ª—è SolarTimer
    headerText.style.color = isNight ? "var(--night-accent)" : "var(--day-accent)";

    // –ö–ª–∞—Å—Å—ã –¥–ª—è –∏–∫–æ–Ω–∫–∏
    iconWrap.className = "icon-astro " + (isNight ? "night":"sun") + (manualTheme ? " manual" : "");
    astroIcon.textContent = isNight ? "üåô" : "‚òÄÔ∏è";
    astroGlow.className = "astro-glow " + (isNight ? "moon":"sun");

    // –û–±–ª–∞–∫–∞/–∑–≤—ë–∑–¥—ã
    if(isNight) { genStars(); }
    document.getElementById('clouds').style.display = isNight ? 'none' : 'block';
    document.getElementById('stars').style.display = isNight ? 'block' : 'none';

    // –ö–Ω–æ–ø–∫–∞ —Å–±—Ä–æ—Å–∞
    overrideBtn.style.display = manualTheme ? 'flex' : 'none';
}

function themeAutoSwitcher(forceUpdate=false) {
    if(manualTheme && !forceUpdate) return;
    if(window.sunData) {
        const now = new Date();
        let currentMins = now.getHours() * 60 + now.getMinutes();
        let isNight = !(currentMins >= window.sunData.sunriseMins && currentMins <= window.sunData.sunsetMins);
        setTheme(isNight);
    }
}
setInterval(themeAutoSwitcher, 6000);

iconWrap.onclick = function(e){
    if(manualTheme === null) {
        // –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º –Ω–∞ –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω—É—é —Ç–µ–º—É
        manualTheme = nightMode ? 'day' : 'night';
        setTheme(manualTheme==='night');
    } else {
        // –ú–µ–Ω—è–µ–º —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –±—ã–ª–∞ —Ä—É—á–Ω–∞—è
        manualTheme = manualTheme==='night' ? 'day' : 'night';
        setTheme(manualTheme==='night');
    }
    e.preventDefault(); e.stopPropagation();
};
overrideBtn.onclick = function(e){
    manualTheme = null;
    themeAutoSwitcher(true);
    e.preventDefault(); e.stopPropagation();
};

autoDetectLocationAndCity();
async function autoDetectLocationAndCity() {
    if (!navigator.geolocation) {
        alert("–í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≥–µ–æ–ª–æ–∫–∞—Ü–∏—é.");
        return;
    }
    navigator.geolocation.getCurrentPosition(async function(pos){
        const lat = Number(pos.coords.latitude).toFixed(4);
        const lon = Number(pos.coords.longitude).toFixed(4);
        document.getElementById('lat').value = lat;
        document.getElementById('lon').value = lon;
        let resp = await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lon}&accept-language=ru`);
        let data = await resp.json();
        let city = data.address.city || data.address.town || data.address.village || data.address.state || data.display_name || '';
        document.getElementById('city').value = city;
        manualTheme = null; // —Å–±—Ä–æ—Å –Ω–∞ –∞–≤—Ç–æ
        overrideBtn.style.display = 'none';
        updateTimes();
    }, function(){
        alert("–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –≤–∞—à–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ.");
    });
}

async function cityToCoords() {
    let city = document.getElementById('city').value.trim();
    if (!city) return;
    let resp = await fetch(`https://nominatim.openstreetmap.org/search?city=${encodeURIComponent(city)}&format=json&limit=1&accept-language=ru`);
    let data = await resp.json();
    if (data && data[0]) {
        document.getElementById('lat').value = Number(data[0].lat).toFixed(4);
        document.getElementById('lon').value = Number(data[0].lon).toFixed(4);
        manualTheme = null;
        overrideBtn.style.display = 'none';
        updateTimes();
    }
}
async function coordsToCity() {
    let lat = document.getElementById('lat').value;
    let lon = document.getElementById('lon').value;
    if (!lat || !lon) return;
    let resp = await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lon}&accept-language=ru`);
    let data = await resp.json();
    let city = data.address.city || data.address.town || data.address.village || data.address.state || data.display_name || '';
    document.getElementById('city').value = city;
    manualTheme = null;
    overrideBtn.style.display = 'none';
    updateTimes();
}
document.getElementById('city').addEventListener('blur', cityToCoords);
document.getElementById('lat').addEventListener('blur', coordsToCity);
document.getElementById('lon').addEventListener('blur', coordsToCity);

async function updateTimes() {
    let lat = document.getElementById('lat').value;
    let lon = document.getElementById('lon').value;
    let date = document.getElementById('date').value;
    if (!lat || !lon || !date) return;
    let sunResp = await fetch(`https://api.sunrise-sunset.org/json?lat=${lat}&lng=${lon}&date=${date}&formatted=0`);
    let sunData = await sunResp.json();
    if (sunData.status !== "OK") {
        document.getElementById('sunrise').textContent = "–í–æ—Å—Ö–æ–¥: –æ—à–∏–±–∫–∞ API";
        document.getElementById('sunset').textContent = "–ó–∞–∫–∞—Ç: –æ—à–∏–±–∫–∞ API";
        return;
    }
    const sunrise = new Date(sunData.results.sunrise);
    const sunset = new Date(sunData.results.sunset);
    function pad(n) { return n.toString().padStart(2,'0'); }
    document.getElementById('sunrise').textContent = `–í–æ—Å—Ö–æ–¥: ${pad(sunrise.getHours())}:${pad(sunrise.getMinutes())}`;
    document.getElementById('sunset').textContent  = `–ó–∞–∫–∞—Ç: ${pad(sunset.getHours())}:${pad(sunset.getMinutes())}`;
    let sunriseMins = sunrise.getHours() * 60 + sunrise.getMinutes();
    let sunsetMins = sunset.getHours() * 60 + sunset.getMinutes();
    let dayLength = sunsetMins - sunriseMins;
    let nightLength = 1440 - dayLength;
    let dayHour = Math.round(dayLength / 12);
    let nightHour = Math.round(nightLength / 12);
    document.getElementById('day-length').textContent = `–î–ª–∏–Ω–∞ –¥–Ω—è: ${dayLength} –º–∏–Ω`;
    document.getElementById('night-length').textContent = `–î–ª–∏–Ω–∞ –Ω–æ—á–∏: ${nightLength} –º–∏–Ω`;
    document.getElementById('day-hour').textContent = `–°–≤–µ—Ç–æ–≤–æ–π —á–∞—Å: ${dayHour} –º–∏–Ω`;
    document.getElementById('night-hour').textContent = `–ù–æ—á–Ω–æ–π —á–∞—Å: ${nightHour} –º–∏–Ω`;
    window.sunData = { sunriseMins, sunsetMins, dayLength, nightLength, dayHour, nightHour };
    themeAutoSwitcher(true);
    updateCurrentTime();
}
function updateCurrentTime() {
    const now = new Date();
    document.getElementById('current-time').textContent = now.toLocaleTimeString('ru-RU', {hour: '2-digit', minute: '2-digit'});
    if (!window.sunData) return;
    let currentMins = now.getHours() * 60 + now.getMinutes();
    let solarTime = '--';
    if (currentMins >= window.sunData.sunriseMins && currentMins <= window.sunData.sunsetMins) {
        let minsSinceSunrise = currentMins - window.sunData.sunriseMins;
        let currentHour = Math.floor(minsSinceSunrise / window.sunData.dayHour) + 1;
        let minutesInHour = minsSinceSunrise % window.sunData.dayHour;
        solarTime = `${currentHour}:${minutesInHour.toString().padStart(2, '0')}`;
    } else {
        let minsSinceSunset = (currentMins > window.sunData.sunsetMins)
            ? (currentMins - window.sunData.sunsetMins)
            : (currentMins + 1440 - window.sunData.sunsetMins);
        let currentHour = Math.floor(minsSinceSunset / window.sunData.nightHour) + 1;
        let minutesInHour = minsSinceSunset % window.sunData.nightHour;
        solarTime = `${currentHour}:${minutesInHour.toString().padStart(2, '0')}`;
    }
    document.getElementById('solar-time').textContent = `–°–≤–µ—Ç–æ–≤–æ–µ –≤—Ä–µ–º—è: ${solarTime}`;
}
setInterval(updateCurrentTime, 1000);
</script>
</body>
</html>
